---
title: üíª Development
date:
  created: 2025-09-03
  updated: 2025-09-03
description: >
  Complete Docker Compose setup for Code Server, Obsidian, and GitLab CE. Includes development tools for code editing, note-taking, and version control.
sidebarTitle: Development
asIndexPage: true
---

# üíª Development Environment Stack

Integrated development environment with code editor, version control, and knowledge management.

## üõ†Ô∏è Service Configuration

- Logging (`default-logging`)
- Labels (`default-labels`)
- Resource limits (`resource-limits`)

### Development Services

```yaml copy showLineNumbers filename="development.yml"
---
x-logging: &default-logging
  driver: loki
  options: &default-logging-options
    loki-url: https://loki.${SYNOLOGY_BASIC_URL}/loki/api/v1/push
    loki-retries: 5
    loki-batch-size: 400
    loki-batch-wait: 2s
    loki-timeout: 10s
    loki-max-backoff: 5s
    loki-min-backoff: 1s
    loki-tenant-id: default

x-labels: &default-labels
  com.centurylinklabs.watchtower.enable: true
  recreat.container: true
  container.label.group: development

x-limits: &resource-limits
  mem_limit: '256m'
  mem_reservation: '64m'
  cpu_shares: '512'
  restart: always
  networks:
    dockerization:

services:
  obsidian:
    container_name: obsidian
    hostname: obsidian
    image: ghcr.io/linuxserver/obsidian:latest
    shm_size: '5gb'
    <<: *resource-limits
    security_opt:
      - no-new-privileges:false
      - seccomp:unconfined
    healthcheck:
      test: timeout 10s bash -c ':> /dev/tcp/127.0.0.1/3000' || exit 1
      interval: 10s
      timeout: 5s
      retries: 3
      start_period: 90s
    logging:
      <<: *default-logging
      options:
        <<: *default-logging-options
        loki-external-labels: job=obsidian
    ports:
      - '${OBSIDIAN_PORT:-3421}:3000'
    volumes:
      - type: bind
        source: /etc/localtime
        target: /etc/localtime
        read_only: true
      - type: bind
        source: ${MOUNT_PATH_DOCKER_ROOT}/obsidian
        target: /config
    environment:
      CUSTOM_USER: ${EMAIL}
      PASSWORD: ${OBSIDIAN_PASSWORD}
      UID: ${UID_NAS_ADMIN:-1026}
      GID: ${GID_NAS_ADMIN:-100}
    labels:
      <<: *default-labels
      monitoring: obsidian
  gitlab:
    container_name: gitlab
    hostname: 'gitlab.${SYNOLOGY_BASIC_URL:?Synology URL required}'
    <<: *resource-limits
    logging:
      <<: *default-logging
      options:
        <<: *default-logging-options
        loki-external-labels: job=gitlab
    environment:
      UID: ${UID_NAS_ADMIN:-1026}
      GID: ${GID_NAS_ADMIN:-100}
      GITLAB_OMNIBUS_CONFIG: |
        external_url 'https://gitlab.${SYNOLOGY_BASIC_URL}'
        gitlab_rails['gitlab_shell_ssh_port'] = 22
        gitlab_rails['gitlab_shell_git_timeout'] = 800
        gitlab_rails['gitlab_email_enabled'] = true
        gitlab_rails['gitlab_email_from'] = '${MAIL_RECEIVER}'
        gitlab_rails['gitlab_email_display_name'] = 'Synology Gitlab'
        gitlab_rails['gitlab_email_reply_to'] = '${MAIL_RECEIVER}'
        gitlab_rails['smtp_enable'] = true
        gitlab_rails['smtp_address'] = '${SMTP_HOST:-smtp.mail.me.com}'
        gitlab_rails['smtp_port'] = '${SMTP_PORT:-587}'
        gitlab_rails['smtp_user_name'] = '${EMAIL}'
        gitlab_rails['smtp_password'] = '${SMTP_PASSWORD}'
        gitlab_rails['smtp_domain'] = 'icloud.com'
        gitlab_rails['smtp_authentication'] = 'login'
        gitlab_rails['smtp_enable_starttls_auto'] = true
        gitlab_rails['gitlab_root_email'] = '${EMAIL}'
        gitlab_rails['lfs_enabled'] = true
        nginx['proxy_connect_timeout'] = 300
        nginx['proxy_read_timeout'] = 3600
        registry['enable'] = true
        registry_external_url 'https://gitlab.${SYNOLOGY_BASIC_URL}:${GITLAB_REGISTRY:-5005}'
    ports:
      - '${GITLAB_HTTPS:-5100}:443'
      - '${GITLAB_REGISTRY:-5101}:5005'
      - '${GITLAB_SSH:-5102}:22'
    volumes:
      - type: bind
        source: ${MOUNT_PATH_DOCKER_ROOT}/gitlab/config
        target: /etc/gitlab
      - type: bind
        source: ${MOUNT_PATH_DOCKER_ROOT}/logs/gitlab
        target: /var/log/gitlab
      - type: bind
        source: ${MOUNT_PATH_DOCKER_ROOT}/gitlab/data
        target: /var/opt/gitlab
      - type: bind
        source: /etc/localtime
        target: /etc/localtime
        read_only: true
    labels:
      <<: *default-labels
      monitoring: gitlab

  gitlab-runner:
    container_name: gitlab-runner
    hostname: gitlab-runner
    <<: *resource-limits
    logging:
      <<: *default-logging
      options:
        <<: *default-logging-options
        loki-external-labels: job=gitlab-runner
    environment:
      UID: ${UID_NAS_ADMIN:-1026}
      GID: ${GID_NAS_ADMIN:-100}
    volumes:
      - type: bind
        source: /etc/localtime
        target: /etc/localtime
        read_only: true
      - type: bind
        source: /var/run/docker.sock
        target: /var/run/docker.sock
        read_only: true
      - type: bind
        source: ${MOUNT_PATH_DOCKER_ROOT}/gitlab/runner
        target: /etc/gitlab-runner
    labels:
      <<: *default-labels
      monitoring: gitlab-runner

networks:
  dockerization:
    external: true
```

## üîê Required Environment Variables

| Variable                 | Description                     | Required       |
| ------------------------ | ------------------------------- | -------------- |
| `SUDO_PASSWORD_VSCODE`   | Code Server password            | ‚úÖ             |
| `OBSIDIAN_PASSWORD`      | Obsidian web interface password | ‚úÖ             |
| `SMTP_PASSWORD`          | GitLab email password           | ‚úÖ             |
| `MOUNT_PATH_DOCKER_ROOT` | Storage path                    | ‚úÖ             |
| `SYNOLOGY_BASIC_URL`     | Base domain for services        | ‚úÖ             |
| `UID_NAS_ADMIN`          | User ID for volume permissions  | ‚ö†Ô∏è Recommended |
| `GID_NAS_ADMIN`          | Group ID for volume permissions | ‚ö†Ô∏è Recommended |

import { Callout } from 'nextra/components'

<Callout type="warning" title="Security Notice">
All sensitive credentials should: - Be stored in `.env` files - Have restricted permissions (`chmod 600`) - Never be committed to version control - Be rotated periodically
</Callout>

## üöÄ Deployment

1. Create `.env` file with required variables
2. **Initialize volumes**

```bash copy showLineNumbers
mkdir -p ${MOUNT_PATH_DOCKER_ROOT}/{obsidian,gitlab/config,gitlab/data,gitlab/runner,logs/gitlab}
chown -R ${UID_NAS_ADMIN:-1026}:${GID_NAS_ADMIN:-100} ${MOUNT_PATH_DOCKER_ROOT}
```

3. **Start services**

```bash copy showLineNumbers
docker-compose up -d
```

4. **Access services**

- Code Server: `https://codeserver.yourdomain.com:${CODE_SERVER:-82}`
- Obsidian: `https://yourdomain.com:${OBSIDIAN_PORT:-3421}`
- GitLab: `https://gitlab.yourdomain.com:${GITLAB_HTTPS:-5100}`

### üîÑ Maintenance

- **Backups**
  - Regularly backup all volume directories
- **Updates**

```bash copy showLineNumbers
docker-compose pull && docker-compose up -d --force-recreate
```

### üìÑ Logs

```bash copy showLineNumbers
docker-compose logs -f
```
